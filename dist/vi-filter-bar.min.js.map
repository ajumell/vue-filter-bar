{"version":3,"sources":["short.js"],"names":["visitorModal","Vue","component","props","data","_availableFilters","filters","numberOfAvailableProperties","collapsed","methods","addFilter","vm","push","filterProperty","filterPropertyLabel","filterValue","filterValueLabel","filterRequired","getFilterFunction","getFilter","getAvailableFilterProperties","addRequiredFilter","propertyLabel","filter","label","values","filerPropertyInUse","old","new","deleteFilter","tempfilters","status","opt","oldLabel","newLabel","newFilter","oldFilter","result","property","length","propsAvailable","triggerCallback","options","uri","$emit","toggleCoppapse","console","log","computed","slice","created","required","template","availableProperties","requestAvailableProperties","getValues","setFilterProperty","previousLabel","setFilterValue","Value","Label","mounted"],"mappings":"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","sourcesContent":["var visitorModal = Vue.component('vi-filter-bar', {\r\n    props: ['options'],\r\n    data: ()=>{\r\n        return {\r\n            _availableFilters : null,\r\n            filters:[],\r\n            numberOfAvailableProperties: 0,\r\n            collapsed: false,\r\n        }\r\n    },\r\n    methods: {\r\n        //i.o.\r\n        addFilter(){\r\n            let vm = this;\r\n            vm.filters.push({\r\n                _availableFilters: vm._availableFilters,\r\n                filterProperty: null,\r\n                filterPropertyLabel: null,\r\n                filterValue: null,\r\n                filterValueLabel: null,\r\n                filterRequired: false,\r\n                getFilterFunction: vm.getFilter,\r\n                getAvailableFilterProperties: vm.getAvailableFilterProperties\r\n            });\r\n        },\r\n\r\n        addRequiredFilter(propertyLabel){\r\n            let vm = this;\r\n\r\n            let filter = vm.getFilter(propertyLabel)\r\n\r\n            vm.filters.push({\r\n                _availableFilters: vm._availableFilters,\r\n                filterProperty: filter.filterProperty,\r\n                filterPropertyLabel: filter.label,\r\n                filterValue: filter.values[0].filterValue,\r\n                filterValueLabel: filter.values[0].label,\r\n                filterRequired: true,\r\n                getFilterFunction: vm.getFilter,\r\n                getAvailableFilterProperties: ()=>{return false}\r\n            });\r\n\r\n            vm.filerPropertyInUse({old:null, new: filter.label})\r\n        },\r\n        //Delete an Filter from the filters array\r\n        deleteFilter(filterProperty){\r\n            let vm = this;\r\n            //delete filter from filters array.\r\n            let tempfilters = []\r\n            \r\n            for(filter of vm.filters){\r\n                if(filter.filterProperty != filterProperty){\r\n                    tempfilters.push(filter);\r\n                }else{\r\n                    filter.status = 1;\r\n                }\r\n            }\r\n            //override filters array with temp array.\r\n            vm.filters = tempfilters;\r\n            if(filterProperty != null){\r\n                vm.getAvailableFilterProperties()\r\n            }\r\n        },\r\n\r\n        //Mark filter property as in use\r\n        filerPropertyInUse(opt){\r\n            let vm = this;\r\n            \r\n            let oldLabel = opt.old;\r\n            let newLabel = opt.new;\r\n\r\n            let newFilter = vm.getFilter(newLabel);\r\n            //set status to 'in use'\r\n            newFilter.status = 0;\r\n            //newFilter.required = false;\r\n\r\n            if(oldLabel){\r\n                let oldFilter = vm.getFilter(oldLabel);\r\n                //set status to 'available'\r\n                oldFilter.status = 1;\r\n            }\r\n        },\r\n\r\n        //This request returns a list of available (not in use) filters\r\n        getAvailableFilterProperties(){\r\n            let vm = this;\r\n            let result = [];\r\n            for (property of vm._availableFilters){\r\n                if(property.status > 0){\r\n                    result.push(property.label)\r\n                }      \r\n            } \r\n            if(result.length > 0){\r\n                vm.propsAvailable = true;\r\n                vm.numberOfAvailableProperties = result.length;\r\n                return result;\r\n            }else{\r\n                vm.propsAvailable = false;\r\n                vm.deleteFilter(null);\r\n                vm.numberOfAvailableProperties = 0;\r\n                return false;\r\n            }\r\n        },\r\n\r\n        //Returns the filter object from the _availableFilters property\r\n        getFilter(propertyLabel){\r\n            \r\n            if(propertyLabel != null){\r\n                let vm = this;\r\n                for(property of vm._availableFilters){\r\n                    if(propertyLabel == property.label){\r\n                        return property;\r\n                    }\r\n                }\r\n            }else{\r\n                return false\r\n            }\r\n        },\r\n        \r\n        triggerCallback(){\r\n            let vm = this;\r\n            vm.options.uri = vm.uri;\r\n            vm.$emit('trigger-callback', vm.options.uri)\r\n        },\r\n\r\n        toggleCoppapse(){\r\n            let vm = this;\r\n            vm.collapsed = !vm.collapsed;\r\n            console.log(vm.collapsed);\r\n        }\r\n    },\r\n    computed: {\r\n        uri(){\r\n            let vm = this;\r\n            let uri = '';\r\n            for(filter of vm.filters){\r\n                if(filter.filterProperty != null && filter.filterValue != null){\r\n                    //build uri string from filter property and value\r\n                    uri += '&'+filter.filterProperty + '=' + filter.filterValue;\r\n                }\r\n            }\r\n            return uri.slice(1, uri.length);\r\n        },\r\n    },\r\n    created: async function(){\r\n        let vm = this;\r\n        \r\n        //Copy filters array and add status property\r\n        vm._availableFilters= vm.options.filters\r\n        for(filter of vm._availableFilters){\r\n            filter.status = 1;\r\n            //add required filters\r\n            if(filter.required){\r\n                vm.addRequiredFilter(filter.label);\r\n            }\r\n        }\r\n\r\n        vm.getAvailableFilterProperties()\r\n        \r\n    },\r\n    template: \r\n    `\r\n    <div class=\"vi-filter-bar\">\r\n        <div class=\"collapse-toggle\">\r\n            <button v-if=\"!collapsed\" type=\"button\" class=\"btn\" v-on:click=\"toggleCoppapse()\"><img class=\"clickable\" src=\"./assets/collapse-close.png\" width=\"15\" height=\"15\"></button>\r\n            <button v-if=\"collapsed\" type=\"button\" class=\"btn\" v-on:click=\"toggleCoppapse()\"><img class=\"clickable\" src=\"./assets/collapse-open.png\" width=\"15\" height=\"15\"></button>\r\n        </div>    \r\n        \r\n        <h5>Filter options</h5>\r\n        \r\n        <table v-if=\"!collapsed\">\r\n            <tr>\r\n                <td v-for=\"filter in filters\">\r\n                    <vi-filter v-bind:filter=\"filter\" v-on:filter-delete=\"deleteFilter($event)\" v-on:filter-property-selected=\"filerPropertyInUse($event)\"></vi-filter>\r\n                </td>\r\n                <td class=\"left\"></td>\r\n                <td>\r\n                    <div v-if=\"true\">\r\n                        <button type=\"button\" class=\"btn\" v-on:click=\"addFilter()\"><img class=\"clickable\" src='./assets/add.png' width=\"20\" height=\"20\"> ({{numberOfAvailableProperties}})</button>\r\n                    </div>\r\n                    \r\n                </td>\r\n                <td>\r\n                    <button type=\"button\" class=\"btn\" v-on:click=\"triggerCallback()\"><img class=\"clickable\" src='./assets/reload.png' width=\"20\" height=\"20\"></button>\r\n                </td>\r\n            </tr>\r\n            \r\n            <p class=\"mono\">{{uri}}</p>\r\n                \r\n        </table>\r\n    </div> \r\n    `\r\n\r\n})\r\nvar visitorModal = Vue.component('vi-filter', {\r\n    props: ['filter'],\r\n    data: ()=>{\r\n        return {\r\n            availableProperties: []\r\n        }\r\n    },\r\n    methods: {\r\n        requestAvailableProperties(){\r\n            let vm = this;\r\n            vm.availableProperties = vm.filter.getAvailableFilterProperties();\r\n        },\r\n        getValues(propertyLabel){\r\n            let vm = this;\r\n\r\n            if(propertyLabel != null){\r\n                let filter = vm.filter.getFilterFunction(propertyLabel);\r\n                return filter.values;\r\n            }else{\r\n                return []\r\n            } \r\n        },\r\n        setFilterProperty(propertyLabel){\r\n            let vm = this;\r\n            //overrides filter Value\r\n            vm.filter.filterValue = null;\r\n            vm.filter.filterValueLabel = null;\r\n\r\n            //get propertyValue for the given property label\r\n            let filter = vm.filter.getFilterFunction(propertyLabel);\r\n            \r\n            let previousLabel = vm.filter.filterPropertyLabel;\r\n\r\n            vm.filter.filterProperty = filter.filterProperty;\r\n            vm.filter.filterPropertyLabel = filter.label;\r\n\r\n            vm.$emit('filter-property-selected', {old: previousLabel, new: vm.filter.filterPropertyLabel});\r\n\r\n            vm.requestAvailableProperties();\r\n\r\n            /**\r\n            if(previousLabel != null){\r\n                let previousfilter = vm.getFilterFromParent(previousLabel);\r\n                previousfilter.status = 1;\r\n            }\r\n            \r\n            filter.status = 0; //mark property as in use.\r\n            */\r\n        },\r\n        setFilterValue(Value, Label){\r\n            let vm = this;\r\n            vm.filter.filterValue = Value;\r\n            vm.filter.filterValueLabel = Label;\r\n            \r\n        },\r\n        deleteFilter(){\r\n            let vm = this;\r\n            \r\n            let filter = vm.filter.getFilterFunction(vm.filter.filterPropertyLabel);\r\n            if(filter){\r\n                filter.status = 1;\r\n            }\r\n            this.$emit('filter-delete', vm.filter.filterProperty);\r\n        },\r\n        \r\n    },\r\n    computed: {   \r\n    },\r\n    mounted: async function(){\r\n        let vm = this;\r\n        //vm.requestAvailableProperties();\r\n        \r\n    },\r\n    template: \r\n    `\r\n    <div class=\"vi-filter\">\r\n        <table>\r\n            <tr>\r\n                <td class=\"left\">\r\n                    <div class=\"btn-group m-1\">\r\n                        <button class=\"btn btn-sm dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\" v-on:click=\"requestAvailableProperties()\">\r\n                            {{filter.filterPropertyLabel}}\r\n                        </button>\r\n                        <div class=\"dropdown-menu\" >\r\n                            <a class=\"dropdown-item clickable\" v-for=\"prop in availableProperties\" v-on:click=\"setFilterProperty(prop)\">{{prop}}</a>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    <div class=\"btn-group m-1\">\r\n                        <button class=\"btn btn-sm dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n                            {{filter.filterValueLabel}}\r\n                        </button>\r\n                        <div class=\"dropdown-menu\">\r\n                            <a class=\"dropdown-item clickable\" v-for=\"value in getValues(filter.filterPropertyLabel)\" v-on:click=\"setFilterValue(value.filterValue, value.label)\">{{value.label}}</a>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td v-if=\"!filter.filterRequired\">\r\n                    <img class=\"clickable\" src='./assets/delete.png' width=\"15\" height=\"15\" v-on:click=\"deleteFilter()\">\r\n                </td>\r\n            </tr>\r\n        </table>\r\n\r\n    </div> \r\n    `\r\n\r\n})"],"file":"vi-filter-bar.min.js"}